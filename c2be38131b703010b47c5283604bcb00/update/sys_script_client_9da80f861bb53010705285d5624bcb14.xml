<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sys_script_client">
    <sys_script_client action="INSERT_OR_UPDATE">
        <active>true</active>
        <applies_extended>false</applies_extended>
        <condition/>
        <description/>
        <field>u_cnpj</field>
        <global>true</global>
        <isolate_script>false</isolate_script>
        <messages/>
        <name>ValidaCNPJ</name>
        <order/>
        <script><![CDATA[function onChange(control, oldValue, newValue, isLoading, isTemplate) {
    if (isLoading || newValue === '') {
        return;
	}
		
    //Type appropriate comment here, and begin script below

	var info = "";
    var err = "";
    var cnpj = newValue.replace(/\D/g, ''); // removendo os caracteres não numéricos
    var tam = cnpj.length;
    if (!(tam == 14 || tam == 0)) { // validando o tamanho
        err = "'" + cnpj + "' Não parece ser um CNPJ Válido!"; // tamanho inválido
        g_form.showFieldMsg('u_cnpj', err, 'error');
    } else {
        if (!validaCNPJ(cnpj)) { // chama a função que valida o CNPJ
            err = "'" + cnpj + "' Não é um CNPJ Válido!"; // se quiser mostrar o erro
            g_form.showFieldMsg('u_cnpj', err, 'error');
        } else {
			var cnpjMask = cnpj.substring(0, 2) + "." + cnpj.substring(2, 5) + "." + cnpj.substring(5, 8) + "/" + cnpj.substring(8, 12) + "-" + cnpj.substring(12, 14);
			info = "''" + cnpjMask + "' É válido e será armazenado no formato apropriado!";
			g_form.showFieldMsg('u_cnpj', info, "info");
		}
    } 
} 

function validaCNPJ(CNPJ) {
    var a = new Array();
    var b = new Number;
    var c = [6, 5, 4, 3, 2, 9, 8, 7, 6, 5, 4, 3, 2];
    for (i = 0; i < 12; i++) {
        a[i] = CNPJ.charAt(i);
        b += a[i] * c[i + 1];
    }
    if ((x = b % 11) < 2) {
        a[12] = 0;
    } else {
        a[12] = 11 - x;
    }
    b = 0;
    for (y = 0; y < 13; y++) {
        b += (a[y] * c[y]);
    }
    if ((x = b % 11) < 2) {
        a[13] = 0;
    } else {
        a[13] = 11 - x;
    }
    if ((CNPJ.charAt(12) != a[12]) || (CNPJ.charAt(13) != a[13])) {
        return false;
    }
    return true;
}]]></script>
        <sys_class_name>sys_script_client</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2021-08-07 19:14:41</sys_created_on>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>9da80f861bb53010705285d5624bcb14</sys_id>
        <sys_mod_count>40</sys_mod_count>
        <sys_name>ValidaCNPJ</sys_name>
        <sys_overrides/>
        <sys_package display_value="Aoop Onboarding" source="c2be38131b703010b47c5283604bcb00">c2be38131b703010b47c5283604bcb00</sys_package>
        <sys_policy/>
        <sys_scope display_value="Aoop Onboarding">c2be38131b703010b47c5283604bcb00</sys_scope>
        <sys_update_name>sys_script_client_9da80f861bb53010705285d5624bcb14</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2021-08-09 19:03:44</sys_updated_on>
        <table>u_vagas</table>
        <type>onChange</type>
        <ui_type>0</ui_type>
        <view/>
    </sys_script_client>
</record_update>
